{% extends "_base.html" %}
{% from "macros/modal.macro" import modal %}
{% block title %} {{char.name}} | Chest {% endblock title %}

{% block head %} 
<style>
</style>

{% endblock head %}
{% block body %}



<div class="jumbotron">

	<h2 id="charname">{{char.name}}</h2>

	<h4 id="charclass" class="text-muted">{{char.ptype}}</h4>

	<blockquote class="blockquote">
		<p id="chardesc" class="mb-0">{{char.description}}</p>
		<footer class="blockquote-footer"><cite title="Source Title">{{eggs | random}}</cite></footer>
	</blockquote>
	<div>
		<button class="btn btn-outline-info" style="vertical-align: right;" onclick="charupdate(this)">edit character</button>
	</div>

</div>


{% if char.inventory %}

<h4>fuzzy search</h4>
<input type="text" class="form-control" placeholder="search query here" id="searchbox">
<br>
<br>

<table class="table table-hover">
	<thead>
		<th scope="col" class="text-primary">Name</th>
		<th scope="col" class="text-primary">Description</th>
	</thead>

	<tbody class="text-secondary" style="width:100%">
		{% for item in char.inventory %}

		<tr class="inventoryrow" id="{{item.itemid}}">
			<td style="width:20%">
				<div id="{{item.itemid}}_name">{{item.name}}</div>
			</td>

			<td style="width:70%">
				<table class="table table-hover">
					<tr>	
						
						<td style="height:75%">
							<div id="{{item.itemid}}_description">{{item.description}}</div>
						</td>

					</tr>
					<tr>
						<td style="text-align: right;" id="{{item.itemid}}_tags">
							{% if item.tags%}
							{%for tag in item.tags%}
							<span class="badge badge-pill badge-dark" style="background-color:{{tagdict[tag]}};">{{tag}}</span>
							{% endfor %}
							{% else %}
							<span class="badge badge-pill badge-light">no tags</span>
							{% endif %}
						</td>
					</tr>

				</table>

			</td>
			<td style="width:10%">
				<button type="button" id="{{item.itemid}}_popover" class="btn btn-outline-secondary btn-sm pop" data-container="body"
					data-toggle="popover" data-placement="right" data-html="true" data-content="
					<button class='btn btn-outline-success btn-sm btn-block' id='{{item.itemid}}' onclick='itemeditor(this)'>update</button> 
					<br><br>
					<button data-toggle='modal' data-target='#copyconfirm' class='btn btn-outline-info btn-sm btn-block' id='{{item.itemid}}' onclick='copyitem(this)'>copy</button>
					<br><br>
					<button class='btn btn-outline-danger btn-sm btn-block' id='{{item.itemid}}' onclick='deleteitem(this)'>delete</button>">
					Options
				</button>
			</td>
		</tr>
		{% endfor %}

	</tbody>


</table>

{% else %}

<h4>no inventory data availible</h4>


{% endif %}
<div class="jumbotron">

	<h4>Add Item</h4>
	<form action="{{url_for('viewcharacter', charid=char.charid)}}" method="post" autocomplete="off">
		<input type="text" id="newname" name="name" class="form-control" placeholder="new item name">
		<input type="text" id="newdesc" name="description" class="form-control" placeholder="new item description">
		<br>
		<u>TAGS</u>
		<br><br>

		<div class="form-check">
			<table class="table table-hover table-sm">
				<tr>
					<td>

						<input type="checkbox" class="form-check-input" id="tag-consumable"
							name="tag-consumable">
						<label class="" for="tag-weapon">consumable</label>
					</td>
					<td>

						<input type="checkbox" class="form-check-input" id="tag-food"
							name="tag-food">
						<label class="" for="tag-weapon">food</label>
					</td>
					<td>

						<input type="checkbox" class="form-check-input" id="tag-potion"
							name="tag-potion">
						<label class="" for="tag-weapon">potion</label>
					</td>
					<td>

						<input type="checkbox" class="form-check-input" id="tag-ingredient"
							name="tag-ingredient">
						<label class="" for="tag-weapon">ingredient</label>
					</td>
				</tr>
				<tr>
					<td>

						<input type="checkbox" class="form-check-input" id="tag-weapon"
							name="tag-weapon">
						<label class="" for="tag-weapon">weapon</label>
					</td>
					<td>

						<input type="checkbox" class="form-check-input"
							id="tag-shortrangedweapon" name="tag-shortrangedweapon">
						<label class="" for="tag-weapon">shortrangedweapon</label>
					</td>
					<td>

						<input type="checkbox" class="form-check-input"
							id="tag-longrangedweapon" name="tag-longrangedweapon">
						<label class="" for="tag-weapon">longrangedweapon</label>
					</td>
					<td>

						<input type="checkbox" class="form-check-input" id="tag-magicalweapon"
							name="tag-magicalweapon">
						<label class="" for="tag-weapon">magicalweapon</label>
					</td>
				</tr>
				<tr>
					<td>

						<input type="checkbox" class="form-check-input" id="tag-armor"
							name="tag-armor">
						<label class="" for="tag-weapon">armor</label>
					</td>
					<td>

						<input type="checkbox" class="form-check-input" id="tag-clothing"
							name="tag-clothing">
						<label class="" for="tag-weapon">clothing</label>
					</td>
				</tr>
				<tr>
					<td>

						<input type="checkbox" class="form-check-input" id="tag-book/scroll"
							name="tag-book/scroll">
						<label class="" for="tag-weapon">book/scroll</label>
					</td>
					<td>

						<input type="checkbox" class="form-check-input" id="tag-spellbook"
							name="tag-spellbook">
						<label class="" for="tag-weapon">spellbook</label>
					</td>
					<td>

						<input type="checkbox" class="form-check-input" id="tag-valuable"
							name="tag-valuable">
						<label class="" for="tag-weapon">valuable</label>
					</td>
					<td>

						<input type="checkbox" class="form-check-input" id="tag-misc"
							name="tag-misc">
						<label class="" for="tag-weapon">misc</label>
					</td>
				</tr>
				<tr>
					<td>

						<input type="checkbox" class="form-check-input" id="tag-magical"
							name="tag-magical">
						<label class="" for="tag-weapon">magical</label>
					</td>
					<td>

						<input type="checkbox" class="form-check-input" id="tag-mundane"
							name="tag-mundane">
						<label class="" for="tag-weapon">mundane</label>
					</td>
				</tr>
				<tr>
					<td>

						<input type="checkbox" class="form-check-input" id="tag-currency"
							name="tag-currency">
						<label class="" for="tag-weapon">currency</label>
					</td>
				</tr>
			</table>

		</div>

		<br>
		<input type="text" name="charid" style="display:none" value='{{char.charid}}'>
		<input type="submit" value="upload" class="btn btn-primary">
	</form>

</div>

{{modal('deletecharmodal','', 'Are you sure you want to delete this character?', '<button type="button" class="btn btn-secondary" data-dismiss="modal">No, take me back</button>
<button type="button" class="btn btn-primary" onclick="chardelete(this)">Yes, delete this character</button>')}}

{{modal('copyconfirm', '', 'Item data copied into the New Item at the bottom of the page')}}

<script>
	charid = {{ char.charid | safe }};
	updateurl = "{{url_for('updateitem', charid=char.charid) | safe}}";
	deleteurl = "{{url_for('deleteitem', charid=char.charid) | safe}}"
	charupdateurl = "{{url_for('updatechar', charid=char.charid) | safe}}"
	chardeleteurl = "{{url_for('deletechar', charid=char.charid) | safe}}"
</script>


<script src="/static/charupdate.js"></script>
<script src="/static/chardelete.js"></script>
<script src="/static/itemupdate.js"></script>
<script src="/static/itemdelete.js"></script>
<script src="/static/itemcopy.js"></script>
<script src="/static/post.js"></script>
<script src="/static/search.js"></script>

{% endblock body %}